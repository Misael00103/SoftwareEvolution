<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturación - Software Evolution</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="facturacion.css">
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
    <div class="app-container">
        <!-- Vista de Listado de Facturas -->
        <section class="view" id="invoiceListView">
            <header class="card header-card">
                <div class="card-header">
                    <div class="header-content">
                        <div class="header-icon">
                            <i data-feather="file-text"></i>
                        </div>
                        <div class="header-text">
                            <h1>Listado de Facturas</h1>
                            <p>Administre las facturas del sistema</p>
                        </div>
                    </div>
                    <div class="header-actions">
                        <div class="user-card">
                            <div class="user-info">
                                <img src="../Assets/perfil.jpg" alt="Usuario" class="user-image">
                                <div class="user-details">
                                    <span class="user-name">Juan Pérez</span>
                                    <span class="user-date" id="invoiceDateList">19/12/2024 14:30</span>
                                </div>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button class="icon-btn" aria-label="Correo"><i data-feather="mail"></i></button>
                            <button class="icon-btn" aria-label="Imprimir"><i data-feather="printer"></i></button>
                            <button class="icon-btn" aria-label="Descargar"><i data-feather="download"></i></button>
                        </div>
                    </div>
                </div>
            </header>
            <div class="content-wrapper">
                <section class="card">
                    <div class="card-header">
                        <h2><i data-feather="list"></i> Facturas</h2>
                        <button class="btn primary" id="addInvoiceBtn">
                            <i data-feather="plus"></i> Nueva Factura
                        </button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>ID Factura</th>
                                        <th>Fecha</th>
                                        <th>Cliente</th>
                                        <th>Total</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="invoiceList"></tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </section>

        <!-- Vista de Configuración de Factura -->
        <section class="view" id="invoiceFormView">
            <header class="card header-card">
                <div class="card-header">
                    <div class="header-content">
                        <div class="header-icon">
                            <i data-feather="file-text"></i>
                        </div>
                        <div class="header-text">
                            <h1 id="formTitle">Nueva Factura</h1>
                            <p id="invoiceId">FACT000274</p>
                        </div>
                    </div>
                    <!-- Modificar la estructura de la tarjeta de usuario para mejorar responsive -->
                    <div class="header-actions">
                        <div class="user-card">
                            <div class="user-info">
                                <img src="../Assets/perfil.jpg" alt="Usuario" class="user-image">
                                <div class="user-details">
                                    <span class="user-name">Juan Pérez</span>
                                    <span class="user-date" id="invoiceDate">19/12/2024 14:30</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <div class="content-grid">
                <!-- Columna izquierda -->
                <div class="main-content">
                    <!-- Información del Cliente -->
                    <section class="card">
                        <div class="card-header">
                            <div class="tabs-container">
                                <div class="tabs">
                                    <button type="button" class="tab active" data-tab="factura-tab"><i data-feather="file-text"></i> Factura</button>
                                    <button type="button" class="tab" data-tab="detalle-tab"><i data-feather="book-open"></i> Detalle Contable</button>
                                    <button class="btn secondary" id="backBtn">
                                        <i data-feather="arrow-left"></i> Volver
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="factura-tab" class="tab-content active">
                                <h3><i data-feather="user"></i> Información del Cliente</h3>
                                <div class="form-grid">
                                    <div class="field">
                                        <label>Cliente</label>
                                        <div class="field-with-helper">
                                            <div class="input-container">
                                                <input type="text" id="clientId" value="1" class="input-small" readonly>
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <div class="input-container">
                                                <input type="text" id="clientName" value="PABLO ALEJANDRO DIAZ CRUZ" readonly>
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <button type="button" class="btn-icon search-client"><i data-feather="search"></i></button>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Límite Crédito</label>
                                        <div class="input-container">
                                            <input type="text" id="creditLimit" value="1,000,000.00" readonly>
                                            <i data-feather="dollar-sign" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Dirección Envío</label>
                                        <div class="input-container">
                                            <input type="text" id="shippingAddress" value="LOS LLANOS DE GURABO TIGAYGA #42, SANTIAGO">
                                            <i data-feather="map-pin" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Teléfono</label>
                                        <div class="input-container">
                                            <input type="text" id="phone" value="(809) 447-7816">
                                            <i data-feather="phone" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Celular</label>
                                        <div class="input-container">
                                            <input type="text" id="mobile" value="(809) 447-7816">
                                            <i data-feather="smartphone" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Vendedor</label>
                                        <div class="field-with-helper">
                                            <div class="input-container">
                                                <input type="text" id="vendorId" value="1" class="input-small" readonly>
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <div class="input-container">
                                                <input type="text" id="vendorName" value="PABLO A DIAZ CRUZ" readonly>
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <button type="button" class="btn-icon search-vendor"><i data-feather="search"></i></button>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Moneda</label>
                                        <div class="input-container">
                                            <select id="currency">
                                                <option value="RD$">RD$</option>
                                                <option value="USD$">USD$</option>
                                                <option value="EUR€">EUR€</option>
                                            </select>
                                            <i data-feather="dollar-sign" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Almacén</label>
                                        <div class="input-container">
                                            <select id="warehouse">
                                                <option value="ALMACEN PRINCIPAL">ALMACEN PRINCIPAL</option>
                                                <option value="ALMACEN SECUNDARIO">ALMACEN SECUNDARIO</option>
                                            </select>
                                            <i data-feather="package" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Proyecto</label>
                                        <div class="input-container">
                                            <select id="project">
                                                <option value="SOFTWARE EVOLUTION ARPA SRL">SOFTWARE EVOLUTION ARPA SRL</option>
                                                <option value="PROYECTO NUEVO">PROYECTO NUEVO</option>
                                            </select>
                                            <i data-feather="briefcase" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Tipo NCF</label>
                                        <div class="input-container">
                                            <select id="ncfType">
                                                <option value="FACTURA VALIDA CREDITO FISCAL">FACTURA VALIDA CREDITO FISCAL</option>
                                                <option value="FACTURA DE CONSUMO">FACTURA DE CONSUMO</option>
                                            </select>
                                            <i data-feather="file-text" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Tipo Venta</label>
                                        <div class="input-container">
                                            <select id="saleType">
                                                <option value="INGRESOS POR OPERACIONES NO FINANCIERAS">INGRESOS POR OPERACIONES NO FINANCIERAS</option>
                                                <option value="VENTA DE PRODUCTOS">VENTA DE PRODUCTOS</option>
                                            </select>
                                            <i data-feather="shopping-cart" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Tipo Papel</label>
                                        <div class="input-container">
                                            <select id="paperType">
                                                <option value="FACTURA PEQUEÑA">FACTURA PEQUEÑA</option>
                                                <option value="FACTURA GRANDE">FACTURA GRANDE</option>
                                            </select>
                                            <i data-feather="printer" class="input-icon"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="payment-options">
                                    <div class="radio-group">
                                        <label class="radio">
                                            <input type="radio" name="paymentType" value="contado">
                                            <span class="radio-mark"></span>
                                            <span>Contado</span>
                                        </label>
                                        <label class="radio">
                                            <input type="radio" name="paymentType" value="credito" checked>
                                            <span class="radio-mark"></span>
                                            <span>Crédito</span>
                                        </label>
                                    </div>
                                    <label class="checkbox">
                                        <input type="checkbox" id="itbisIncluded" checked>
                                        <span class="checkbox-mark"></span>
                                        <span>Itbis Encima</span>
                                    </label>
                                    <div class="field">
                                        <label>%Tarjeta</label>
                                        <div class="input-container">
                                            <input type="text" id="cardPercentage" value="0.00" class="input-small">
                                            <i data-feather="percent" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Tasa</label>
                                        <div class="input-container">
                                            <input type="text" id="rate" value="1.00" class="input-small">
                                            <i data-feather="dollar-sign" class="input-icon"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="detalle-tab" class="tab-content">
                                <h3><i data-feather="book-open"></i> Detalle Contable</h3>
                                <div class="table-responsive">
                                    <table class="table" id="accountingTable">
                                        <thead>
                                            <tr>
                                                <th>Cuenta</th>
                                                <th>Descripción</th>
                                                <th>Débito</th>
                                                <th>Crédito</th>
                                            </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Productos -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="package"></i> Productos</h3>
                            <div class="table-actions">
                                <button class="btn primary" data-action="add-product"><i data-feather="plus"></i> Añadir</button>
                                <div class="search-container">
                                    <input type="text" id="productSearch" placeholder="Buscar producto...">
                                    <i data-feather="search"></i>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Código</th>
                                            <th>Referencia</th>
                                            <th>Descripción</th>
                                            <th>Cant.</th>
                                            <th>Precio</th>
                                            <th>Impuesto</th>
                                            <th>Total</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="productList"></tbody>
                                </table>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Columna derecha (Sidebar) -->
                <aside class="side-panel">
                    <!-- Comentario de Factura -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="message-square"></i> Comentario de Factura</h3>
                        </div>
                        <div class="card-body">
                            <textarea id="invoiceComment" placeholder="Agregar comentario..."></textarea>
                            <div class="comment-history">
                                <h4>Historial de comentarios</h4>
                                <ul id="commentList">
                                    <li>Cliente recibió su producto</li>
                                </ul>
                            </div>
                        </div>
                    </section>

                    <!-- Gestión de Clientes -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="users"></i> Gestión de Clientes</h3>
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="add-client"><i data-feather="plus"></i> Agregar Nuevo Cliente</button>
                                <button class="btn secondary" data-action="view-clients"><i data-feather="list"></i> Ver Clientes</button>
                            </div>
                        </div>
                    </section>

                    <!-- Gestión de Pedidos -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="package"></i> Gestión de Pedidos</h3>
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="create-order"><i data-feather="plus"></i> Crear Pedido</button>
                                <button class="btn secondary" data-action="view-orders"><i data-feather="list"></i> Ver Pedidos</button>
                            </div>
                        </div>
                    </section>

                    <!-- Gestión de Facturas -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="file-text"></i> Gestión de Facturas</h3>
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="view-invoices"><i data-feather="list"></i> Ver Facturas</button>
                            </div>
                        </div>
                    </section>

                    <!-- Totales -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="calculator"></i> Totales</h3>
                        </div>
                        <div class="card-body">
                            <div class="totals-grid">
                                <div class="total-item"><span>Total Bruto:</span><span id="grossTotal">26,196.00</span></div>
                                <div class="total-item"><span>Descuento 1:</span><span id="discount1">0.00</span></div>
                                <div class="total-item"><span>Desc. Items:</span><span id="itemDiscount">0.00</span></div>
                                <div class="total-item"><span>Flete (Envío):</span><span id="shipping">0.00</span></div>
                                <div class="total-item"><span>Monto Exento:</span><span id="exemptAmount">0.00</span></div>
                                <div class="total-item"><span>Base Imponible:</span><span id="taxableBase">22,200.00</span></div>
                                <div class="total-item"><span>Itbis:</span><span id="itbis">3,996.00</span></div>
                                <div class="total-item"><span>30 % Itbis:</span><span id="itbis30">0.00</span></div>
                                <div class="total-item total"><span>Total Neto:</span><span id="netTotal">26,196.00</span></div>
                            </div>
                        </div>
                    </section>

                    <!-- Botones de Acción -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="settings"></i> Acciones</h3>
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="change-price"><i data-feather="dollar-sign"></i> Cambiar Precio</button>
                                <button class="btn secondary" data-action="apply-discount"><i data-feather="percent"></i> Descuento Items</button>
                                <button class="btn secondary" data-action="search-product"><i data-feather="search"></i> Buscar Producto</button>
                                <button class="btn secondary" data-action="view-image"><i data-feather="image"></i> Ver Imagen</button>
                                <button class="btn secondary" data-action="delete-line"><i data-feather="trash"></i> Borrar Línea</button>
                                <button class="btn secondary" data-action="load-order"><i data-feather="shopping-cart"></i> Cargar Pedido [F5]</button>
                                <button class="btn secondary" data-action="authorize"><i data-feather="check-circle"></i> Autorización [F8]</button>
                            </div>
                        </div>
                    </section>

                    <!-- Detalles del Producto -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="info"></i> Detalles del Producto</h3>
                        </div>
                        <div class="card-body">
                            <div class="info-grid">
                                <div class="field">
                                    <label>Código</label>
                                    <div class="input-container">
                                        <input type="text" id="productCode" value="10" readonly>
                                        <i data-feather="hash" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Descripción</label>
                                    <div class="input-container">
                                        <input type="text" id="productDescription" value="CPU DELL CI5 DESKTOP" readonly>
                                        <i data-feather="info" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Precio 1</label>
                                    <div class="input-container">
                                        <input type="text" id="productPrice1" value="10,500.00" readonly>
                                        <i data-feather="dollar-sign" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Precio 2</label>
                                    <div class="input-container">
                                        <input type="text" id="productPrice2" value="10,500.00" readonly>
                                        <i data-feather="dollar-sign" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Existencia</label>
                                    <div class="input-container">
                                        <input type="text" id="productStock" value="5.00" readonly>
                                        <i data-feather="package" class="input-icon"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Imagen del Producto -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="image"></i> Imagen del Producto</h3>
                        </div>
                        <div class="card-body">
                            <div class="image-container">
                                <img id="productImage" src="https://via.placeholder.com/150" alt="Imagen del producto">
                            </div>
                            <button class="btn secondary" data-action="change-image"><i data-feather="image"></i> Cambiar Imagen</button>
                        </div>
                    </section>

                    <!-- Botones Finales -->
                    <section class="card">
                        <div class="card-body">
                            <div class="main-actions">
                                <button class="btn primary" data-action="save"><i data-feather="save"></i> Salvar Factura [F11]</button>
                                <button class="btn secondary" data-action="exit"><i data-feather="x"></i> Salir</button>
                            </div>
                        </div>
                    </section>
                </aside>
            </div>
        </section>

        <!-- Toast -->
        <div id="toast" class="toast">
            <div class="toast-icon">
                <i data-feather="check-circle"></i>
            </div>
            <div class="toast-content">
                <p class="toast-title">Éxito</p>
                <p class="toast-message" id="toastMessage">Acción completada correctamente</p>
            </div>
            <button class="toast-close"><i data-feather="x"></i></button>
        </div>

        <!-- Modal -->
        <div class="confirm-dialog" id="myModal">
            <div class="confirm-dialog-content card">
                <div class="card-header">
                    <h3><i data-feather="info"></i> Información</h3>
                    <button class="modal-close close"><i data-feather="x"></i></button>
                </div>
                <div class="card-body">
                    <div id="modalMessage"></div>
                </div>
                <div class="main-actions modal-actions">
                    <button id="modalConfirm" class="btn primary">Confirmar</button>
                    <button id="modalCancel" class="btn secondary">Cancelar</button>
                </div>
            </div>
        </div>

        <!-- Modal de Selección de Productos -->
        <div class="confirm-dialog" id="productModal">
            <div class="confirm-dialog-content card">
                <div class="card-header">
                    <h3><i data-feather="package"></i> Seleccionar Producto</h3>
                    <button class="modal-close close product-modal-close"><i data-feather="x"></i></button>
                </div>
                <div class="card-body">
                    <div class="search-container mb-3">
                        <input type="text" id="modalProductSearch" placeholder="Buscar producto por código o descripción...">
                        <i data-feather="search"></i>
                    </div>
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Código</th>
                                    <th>Descripción</th>
                                    <th>Precio</th>
                                    <th>Existencia</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="modalProductList"></tbody>
                        </table>
                    </div>
                </div>
                <div class="main-actions modal-actions">
                    <button id="productModalCancel" class="btn secondary">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    <script src="facturacion.js"></script>
</body>
</html>

