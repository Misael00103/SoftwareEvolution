<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturación - Software Evolution</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="facturacion.css">
    <script src="https://unpkg.com/feather-icons"></script>
</head>
<body>
    <div class="app-container">
        <!-- Vista de Listado de Facturas -->
        <header class="card">
            <div class="card-header">
                <div class="header-content">
                    <div class="header-icon">
                        <i data-feather="file-text"></i>
                    </div>
                    <div class="header-text">
                        <h1>Gestión de Facturas</h1>
                        <p>Administre las facturas del sistema</p>
                    </div>
                </div>
                <div class="header-actions">
                    <div class="action-buttons">
                        <button class="icon-btn" aria-label="Correo"><i data-feather="mail"></i></button>
                        <button class="icon-btn" aria-label="Imprimir"><i data-feather="printer"></i></button>
                        <button class="icon-btn" aria-label="Descargar"><i data-feather="download"></i></button>
                    </div>
                    <div class="user-card">
                        <div class="user-info">
                            <img src="../Assets/user-avatar.png" alt="Usuario" class="user-image" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2732%27 height=%2732%27 viewBox=%270 0 32 32%27%3E%3Ccircle cx=%2716%27 cy=%2716%27 r=%2716%27 fill=%27%23fbbf24%27/%3E%3Ctext x=%2716%27 y=%2721%27 font-size=%2718%27 text-anchor=%27middle%27 fill=%27white%27 font-weight=%27bold%27%3EU%3C/text%3E%3C/svg%3E'">
                            <div class="user-details">
                                <span class="user-name">Usuario Actual</span>
                                <span class="user-date" id="currentDate"></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <main>
            <section class="view active" id="invoiceListView">
                <div class="content-grid">
                    <div class="main-content">
                        <section class="card">
                            <div class="card-header">
                                <h2><i data-feather="list"></i> Listado de Facturas</h2>
                                <button class="btn primary" id="addInvoiceBtn">
                                    <i data-feather="plus"></i> Nueva Factura
                                </button>
                            </div>
                            <div class="card-body">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Fecha</th>
                                            <th>Cliente</th>
                                            <th>Total</th>
                                            <th>Estado</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="invoiceList"></tbody>
                                </table>
                            </div>
                        </section>
                    </div>
                </div>
            </section>

            <!-- Vista de Configuración de Factura -->
            <section class="view" id="invoiceFormView">
                <div class="content-grid">
                <!-- Columna izquierda -->
                <div class="main-content">
                    <!-- Información del Cliente -->
                    <section class="card">
                        <div class="card-header">
                            <div class="tabs-container">
                                <div class="tabs">
                                    <button type="button" class="tab active" data-tab="factura-tab"><i data-feather="file-text"></i> Factura</button>
                                    <button type="button" class="tab" data-tab="detalle-tab"><i data-feather="book-open"></i> Detalle</button> <!-- Shortened -->
                                    <button class="btn secondary" id="backBtn">
                                        <i data-feather="arrow-left"></i> Volver
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="factura-tab" class="tab-content active">
                                <h3><i data-feather="user"></i> Info. Cliente</h3> <!-- Shortened -->
                                <div class="form-grid">
                                    <div class="field">
                                        <label>Cliente</label>
                                        <div class="field-with-helper">
                                            <div class="input-container">
                                                <input type="text" id="clientId" value="1" class="input-small" readonly>
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <div class="input-container">
                                                <input type="text" id="clientName" value="PABLO A. DIAZ" readonly> <!-- Shortened value -->
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <button type="button" class="btn-icon search-client"><i data-feather="search"></i></button>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Límite</label> <!-- Shortened -->
                                        <div class="input-container">
                                            <input type="text" id="creditLimit" value="1M" readonly> <!-- Shortened value -->
                                            <i data-feather="dollar-sign" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Dirección</label> <!-- Shortened -->
                                        <div class="input-container">
                                            <input type="text" id="shippingAddress" value="LLANOS GURABO #42, STI">
                                            <i data-feather="map-pin" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Tel.</label> <!-- Shortened -->
                                        <div class="input-container">
                                            <input type="text" id="phone" value="(809) 447-7816">
                                            <i data-feather="phone" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Cel.</label> <!-- Shortened -->
                                        <div class="input-container">
                                            <input type="text" id="mobile" value="(809) 447-7816">
                                            <i data-feather="smartphone" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Vendedor</label>
                                        <div class="field-with-helper">
                                            <div class="input-container">
                                                <input type="text" id="vendorId" value="1" class="input-small" readonly>
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <div class="input-container">
                                                <input type="text" id="vendorName" value="PABLO DIAZ" readonly> <!-- Shortened -->
                                                <i data-feather="user" class="input-icon"></i>
                                            </div>
                                            <button type="button" class="btn-icon search-vendor"><i data-feather="search"></i></button>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Moneda</label>
                                        <div class="input-container">
                                            <select id="currency">
                                                <option value="RD$">RD$</option>
                                                <option value="USD$">USD$</option>
                                                <option value="EUR€">EUR€</option>
                                            </select>
                                            <i data-feather="dollar-sign" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Almacén</label>
                                        <div class="input-container">
                                            <select id="warehouse">
                                                <option value="ALMACEN PRINCIPAL">PRINCIPAL</option> <!-- Shortened -->
                                                <option value="ALMACEN SECUNDARIO">SECUNDARIO</option> <!-- Shortened -->
                                            </select>
                                            <i data-feather="package" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Proyecto</label>
                                        <div class="input-container">
                                            <select id="project">
                                                <option value="SOFTWARE EVOLUTION ARPA SRL">SOFT. EVO.</option> <!-- Shortened -->
                                                <option value="PROYECTO NUEVO">NUEVO</option> <!-- Shortened -->
                                            </select>
                                            <i data-feather="briefcase" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>NCF</label> <!-- Shortened -->
                                        <div class="input-container">
                                            <select id="ncfType">
                                                <option value="FACTURA VALIDA CREDITO FISCAL">CRÉDITO FISCAL</option> <!-- Shortened -->
                                                <option value="FACTURA DE CONSUMO">CONSUMO</option> <!-- Shortened -->
                                            </select>
                                            <i data-feather="file-text" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Venta</label> <!-- Shortened -->
                                        <div class="input-container">
                                            <select id="saleType">
                                                <option value="INGRESOS POR OPERACIONES NO FINANCIERAS">INGRESOS</option> <!-- Shortened -->
                                                <option value="VENTA DE PRODUCTOS">PRODUCTOS</option> <!-- Shortened -->
                                            </select>
                                            <i data-feather="shopping-cart" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Papel</label> <!-- Shortened -->
                                        <div class="input-container">
                                            <select id="paperType">
                                                <option value="FACTURA PEQUEÑA">PEQUEÑA</option> <!-- Shortened -->
                                                <option value="FACTURA GRANDE">GRANDE</option> <!-- Shortened -->
                                            </select>
                                            <i data-feather="printer" class="input-icon"></i>
                                        </div>
                                    </div>
                                </div>
                                <div class="payment-options">
                                    <div class="radio-group">
                                        <label class="radio">
                                            <input type="radio" name="paymentType" value="contado">
                                            <span class="radio-mark"></span>
                                            <span>Contado</span>
                                        </label>
                                        <label class="radio">
                                            <input type="radio" name="paymentType" value="credito" checked>
                                            <span class="radio-mark"></span>
                                            <span>Crédito</span>
                                        </label>
                                    </div>
                                    <label class="checkbox">
                                        <input type="checkbox" id="itbisIncluded" checked>
                                        <span class="checkbox-mark"></span>
                                        <span>Itbis</span> <!-- Shortened -->
                                    </label>
                                    <div class="field">
                                        <label>%Tarjeta</label>
                                        <div class="input-container">
                                            <input type="text" id="cardPercentage" value="0.00" class="input-small">
                                            <i data-feather="percent" class="input-icon"></i>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>Tasa</label>
                                        <div class="input-container">
                                            <input type="text" id="rate" value="1.00" class="input-small">
                                            <i data-feather="dollar-sign" class="input-icon"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div id="detalle-tab" class="tab-content">
                                <h3><i data-feather="book-open"></i> Detalle</h3> <!-- Shortened -->
                                <table class="table" id="accountingTable">
                                    <thead>
                                        <tr>
                                            <th>Cuenta</th>
                                            <th>Descripción</th>
                                            <th>Débito</th>
                                            <th>Crédito</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    <!-- Productos -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="package"></i> Productos</h3>
                            <div class="table-actions">
                                <button class="btn primary" data-action="add-product"><i data-feather="plus"></i> Añadir</button>
                                <div class="search-container">
                                    <input type="text" id="productSearch" placeholder="Buscar..."> <!-- Shortened placeholder -->
                                    <i data-feather="search"></i>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Código</th>
                                        <th>Referencia</th>
                                        <th>Descripción</th>
                                        <th>Cantidad</th>
                                        <th>Precio</th>
                                        <th>Impuesto</th>
                                        <th>Total</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="productList"></tbody>
                            </table>
                        </div>
                    </section>
                </div>

                <!-- Columna derecha (Sidebar) -->
                <aside class="side-panel">
                    <!-- Comentario de Factura -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="message-square"></i> Comentario</h3> <!-- Shortened -->
                        </div>
                        <div class="card-body">
                            <textarea id="invoiceComment" placeholder="Agregar..."></textarea> <!-- Shortened placeholder -->
                            <div class="comment-history">
                                <h4>Historial</h4> <!-- Shortened -->
                                <ul id="commentList">
                                    <li>Cliente recibió producto</li> <!-- Shortened -->
                                </ul>
                            </div>
                        </div>
                    </section>

                     <!-- Totales -->
                     <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="hash"></i> Totales</h3>
                        </div>
                        <div class="card-body">
                            <div class="totals-grid">
                                <div class="total-item"><span>Bruto:</span><span id="grossTotal">26,196</span></div> <!-- Shortened -->
                                <div class="total-item"><span>Desc. 1:</span><span id="discount1">0.00</span></div> <!-- Shortened -->
                                <div class="total-item"><span>Desc. It.:</span><span id="itemDiscount">0.00</span></div> <!-- Shortened -->
                                <div class="total-item"><span>Flete:</span><span id="shipping">0.00</span></div> <!-- Shortened -->
                                <div class="total-item"><span>Exento:</span><span id="exemptAmount">0.00</span></div> <!-- Shortened -->
                                <div class="total-item"><span>Base:</span><span id="taxableBase">22,200</span></div> <!-- Shortened -->
                                <div class="total-item"><span>Itbis:</span><span id="itbis">3,996</span></div> <!-- Shortened -->
                                <div class="total-item"><span>30% Itbis:</span><span id="itbis30">0.00</span></div>
                                <div class="total-item total"><span>Neto:</span><span id="netTotal">26,196</span></div> <!-- Shortened -->
                            </div>
                        </div>
                    </section>
                    
                    <!-- Gestión de Clientes -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="users"></i> Clientes</h3> <!-- Shortened -->
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="add-client"><i data-feather="plus"></i> Nuevo</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="view-clients"><i data-feather="list"></i> Ver</button> <!-- Shortened -->
                            </div>
                        </div>
                    </section>

                    <!-- Gestión de Pedidos -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="package"></i> Pedidos</h3> <!-- Shortened -->
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="create-order"><i data-feather="plus"></i> Crear</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="view-orders"><i data-feather="list"></i> Ver</button> <!-- Shortened -->
                            </div>
                        </div>
                    </section>

                    <!-- Gestión de Facturas -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="file-text"></i> Facturas</h3> <!-- Shortened -->
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="view-invoices"><i data-feather="list"></i> Ver</button> <!-- Shortened -->
                            </div>
                        </div>
                    </section>

                    <!-- Botones de Acción -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="settings"></i> Acciones</h3>
                        </div>
                        <div class="card-body">
                            <div class="management-actions">
                                <button class="btn secondary" data-action="change-price"><i data-feather="dollar-sign"></i> Precio</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="apply-discount"><i data-feather="percent"></i> Desc.</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="search-product"><i data-feather="search"></i> Buscar</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="view-image"><i data-feather="image"></i> Imagen</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="delete-line"><i data-feather="trash"></i> Borrar</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="load-order"><i data-feather="shopping-cart"></i> Pedido [F5]</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="authorize"><i data-feather="check-circle"></i> Aut. [F8]</button> <!-- Shortened -->
                            </div>
                        </div>
                    </section>

                    <!-- Detalles del Producto -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="info"></i> Detalle Prod.</h3> <!-- Shortened -->
                        </div>
                        <div class="card-body">
                            <div class="info-grid">
                                <div class="field">
                                    <label>Código</label>
                                    <div class="input-container">
                                        <input type="text" id="productCode" value="10" readonly>
                                        <i data-feather="hash" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Desc.</label> <!-- Shortened -->
                                    <div class="input-container">
                                        <input type="text" id="productDescription" value="CPU DELL CI5" readonly> <!-- Shortened -->
                                        <i data-feather="info" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Precio 1</label>
                                    <div class="input-container">
                                        <input type="text" id="productPrice1" value="10,500" readonly> <!-- Shortened -->
                                        <i data-feather="dollar-sign" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Precio 2</label>
                                    <div class="input-container">
                                        <input type="text" id="productPrice2" value="10,500" readonly> <!-- Shortened -->
                                        <i data-feather="dollar-sign" class="input-icon"></i>
                                    </div>
                                </div>
                                <div class="field">
                                    <label>Exist.</label> <!-- Shortened -->
                                    <div class="input-container">
                                        <input type="text" id="productStock" value="5.00" readonly>
                                        <i data-feather="package" class="input-icon"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Imagen del Producto -->
                    <section class="card">
                        <div class="card-header">
                            <h3><i data-feather="image"></i> Imagen</h3> <!-- Shortened -->
                        </div>
                        <div class="card-body">
                            <div class="image-container">
                                <img id="productImage" src="https://via.placeholder.com/150" alt="Imagen del producto">
                            </div>
                            <button class="btn secondary" data-action="change-image"><i data-feather="image"></i> Cambiar</button> <!-- Shortened -->
                        </div>
                    </section>

                    <!-- Botones Finales -->
                    <section class="card">
                        <div class="card-body">
                            <div class="main-actions">
                                <button class="btn primary" data-action="save"><i data-feather="save"></i> Guardar [F11]</button> <!-- Shortened -->
                                <button class="btn secondary" data-action="exit"><i data-feather="x"></i> Salir</button>
                            </div>
                        </div>
                    </section>
                </aside>
                </div>
            </section>
        </main>

        <!-- Toast -->
        <div id="toast" class="toast">
            <div class="toast-icon">
                <i data-feather="check-circle"></i>
            </div>
            <div class="toast-content">
                <p class="toast-title">Éxito</p>
                <p class="toast-message" id="toastMessage">Acción completada</p> <!-- Shortened -->
            </div>
            <button class="toast-close"><i data-feather="x"></i></button>
        </div>

        <!-- Modal -->
        <div class="confirm-dialog" id="myModal">
            <div class="confirm-dialog-content card">
                <div class="card-header">
                    <h3><i data-feather="info"></i> Info.</h3> <!-- Shortened -->
                    <button class="modal-close close"><i data-feather="x"></i></button>
                </div>
                <div class="card-body">
                    <div id="modalMessage"></div>
                </div>
                <div class="main-actions modal-actions">
                    <button id="modalConfirm" class="btn primary">Confirmar</button>
                    <button id="modalCancel" class="btn secondary">Cancelar</button>
                </div>
            </div>
        </div>

        <!-- Modal de Selección de Productos -->
        <div class="confirm-dialog" id="productModal">
            <div class="confirm-dialog-content card">
                <div class="card-header">
                    <h3><i data-feather="package"></i> Seleccionar</h3> <!-- Shortened -->
                    <button class="modal-close close product-modal-close"><i data-feather="x"></i></button>
                </div>
                <div class="card-body">
                    <div class="search-container mb-3">
                        <input type="text" id="modalProductSearch" placeholder="Buscar..."> <!-- Shortened -->
                        <i data-feather="search"></i>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Código</th>
                                <th>Descripción</th>
                                <th>Precio</th>
                                <th>Existencia</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="modalProductList"></tbody>
                    </table>
                </div>
                <div class="main-actions modal-actions">
                    <button id="productModalCancel" class="btn secondary">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
    <script src="facturacion.js"></script>
</body>
</html>